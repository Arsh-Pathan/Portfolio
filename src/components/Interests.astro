---
const interests = [
  {
    id: "coding",
    title: "Agentic AI",
    type: "code",
    content: `class Agent:\n    def __init__(self):\n        self.mind = "üß†"\n        self.autonomy = True\n    \n    def think(self, context):\n        plan = self.analyze(context)\n        return self.execute(plan)`,
    language: "python",
  },
  {
    id: "quantum",
    title: "Quantum Computing",
    type: "math",
    content: `|œà‚ü© = Œ±|0‚ü© + Œ≤|1‚ü©`,
    subContent: `H|0‚ü© = (|0‚ü© + |1‚ü©)/‚àö2`,
  },
  {
    id: "web",
    title: "Modern Web",
    type: "browser",
    content: "<div class='future'>\n  <h1>Hello World</h1>\n</div>",
  },
  {
    id: "hpc",
    title: "HPC Performance",
    type: "terminal",
    content: `> mpirun -np 4 ./solver\n[0] Rank 0: Initializing...\n[1] Rank 1: Ready\n[2] Rank 2: Ready\n[3] Rank 3: Ready\n> Benchmark: 98.5 TFLOPS`,
  },
  {
    id: "iot",
    title: "IoT Sensor Data",
    type: "graph",
    content: "Sensor Stream",
  },
];
---

<section
  id="interests"
  class="section interests-section relative overflow-hidden"
>
  <div class="container relative z-10">
    <div class="text-center mb-16">
      <div class="section-label justify-center flex">Passions</div>
      <h2 class="section-title">
        Areas of <span class="gradient-text">Interest</span>
      </h2>
    </div>

    <div class="interests-grid">
      {
        interests.map((item, index) => (
          <div
            class={`interest-window glass ${item.type}-window`}
            data-speed={Math.random() * 0.5 + 0.5}
          >
            <div class="win-header">
              <div class="win-dots">
                <span class="dot dot-red" />
                <span class="dot dot-yellow" />
                <span class="dot dot-green" />
              </div>
              <span class="win-title">{item.title}</span>
              <div class="w-8" />
            </div>
            <div class="win-body">
              {item.type === "code" && (
                <pre class="font-mono text-sm text-green-400 leading-relaxed whitespace-pre-wrap">
                  <code>{item.content}</code>
                </pre>
              )}
              {item.type === "math" && (
                <div class="flex flex-col items-center justify-center h-full text-white gap-4">
                  <div class="text-2xl font-serif italic">{item.content}</div>
                  <div class="text-lg font-serif text-white/50">
                    {item.subContent}
                  </div>
                </div>
              )}
              {item.type === "browser" && (
                <div class="bg-white/5 h-full rounded-md p-4">
                  <div class="border-b border-white/10 pb-2 mb-3 text-xs text-gray-500 flex gap-2">
                    <span class="bg-white/10 px-2 py-0.5 rounded text-gray-400">
                      localhost:3000
                    </span>
                  </div>
                  <pre class="text-xs text-purple-400 font-mono">
                    {item.content}
                  </pre>
                </div>
              )}
              {item.type === "terminal" && (
                <div class="font-mono text-xs text-gray-300">
                  {item.content.split("\n").map((line: string) => (
                    <div class="mb-1">
                      <span class="text-blue-400 mr-1">
                        {line.startsWith(">") ? "$" : " "}
                      </span>
                      {line}
                    </div>
                  ))}
                  <div class="inline-block w-2 h-4 bg-blue-400/60 animate-pulse align-middle ml-1" />
                </div>
              )}
              {item.type === "graph" && (
                <div class="flex items-end justify-between h-full gap-1 px-2 pb-2">
                  {[40, 70, 55, 85, 60, 90, 75].map((h: number) => (
                    <div
                      class="w-full rounded-t-sm transition-all duration-1000"
                      style={`height: ${h}%; background: linear-gradient(180deg, #3b82f6, rgba(59,130,246,0.2));`}
                    />
                  ))}
                </div>
              )}
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    gsap.from(".interests-section .section-label", {
      scrollTrigger: { trigger: ".interests-section", start: "top 80%" },
      y: 30,
      opacity: 0,
      filter: "blur(8px)",
      duration: 0.8,
      ease: "power3.out",
    });

    gsap.from(".interests-section .section-title", {
      scrollTrigger: { trigger: ".interests-section", start: "top 80%" },
      y: 40,
      opacity: 0,
      filter: "blur(10px)",
      duration: 1,
      delay: 0.15,
      ease: "power3.out",
    });

    const windows = document.querySelectorAll(".interest-window");

    windows.forEach((win, index) => {
      // Scroll reveal with stagger
      gsap.from(win, {
        scrollTrigger: {
          trigger: win,
          start: "top 90%",
          toggleActions: "play none none reverse",
        },
        y: 50,
        opacity: 0,
        scale: 0.95,
        filter: "blur(6px)",
        duration: 0.8,
        delay: index * 0.1,
        ease: "power3.out",
      });

      // Gentle floating
      gsap.to(win, {
        y: `+=${Math.random() * 12 - 6}`,
        duration: 3 + Math.random() * 2,
        repeat: -1,
        yoyo: true,
        ease: "sine.inOut",
        delay: index * 0.3,
      });

      // Hover glow
      win.addEventListener("mouseenter", () => {
        gsap.to(win, { scale: 1.03, duration: 0.3, ease: "power2.out" });
      });
      win.addEventListener("mouseleave", () => {
        gsap.to(win, { scale: 1, duration: 0.3, ease: "power2.out" });
      });
    });

    // Parallax on mouse move (desktop)
    const container = document.querySelector(".interests-grid");
    if (container && window.innerWidth > 768) {
      document.addEventListener("mousemove", (e) => {
        const mx = (e.clientX / window.innerWidth - 0.5) * 2;
        const my = (e.clientY / window.innerHeight - 0.5) * 2;

        windows.forEach((win) => {
          const speed = parseFloat((win as HTMLElement).dataset.speed || "1");
          gsap.to(win, {
            x: mx * 15 * speed,
            y: my * 15 * speed,
            rotationY: mx * 3,
            rotationX: -my * 3,
            duration: 1.2,
            ease: "power2.out",
          });
        });
      });
    }
  });
</script>

<style>
  .interests-section {
    background: linear-gradient(180deg, #0a0f1c, #0d1427);
    padding: 8rem 0;
  }

  .interests-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    max-width: 1100px;
    margin: 0 auto;
    perspective: 1000px;
  }

  .interest-window {
    position: relative;
    overflow: hidden;
    transition: box-shadow 0.3s ease;
    will-change: transform;
  }

  .interest-window:hover {
    box-shadow:
      0 25px 50px rgba(0, 0, 0, 0.4),
      0 0 40px rgba(59, 130, 246, 0.08);
  }

  .win-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    background: rgba(255, 255, 255, 0.03);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 1.5rem 1.5rem 0 0;
  }

  .win-dots {
    display: flex;
    gap: 6px;
  }

  .dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
  }

  .dot-red {
    background: rgba(239, 68, 68, 0.7);
  }
  .dot-yellow {
    background: rgba(245, 158, 11, 0.7);
  }
  .dot-green {
    background: rgba(34, 197, 94, 0.7);
  }

  .win-title {
    font-size: 0.75rem;
    font-family: "JetBrains Mono", monospace;
    color: rgba(255, 255, 255, 0.5);
    letter-spacing: 0.03em;
  }

  .win-body {
    padding: 1.25rem;
    min-height: 180px;
  }

  @media (max-width: 768px) {
    .interests-section {
      padding: 5rem 0;
    }

    .interests-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
