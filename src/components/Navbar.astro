---
const navLinks = [
  { label: "Home", href: "#home" },
  { label: "Skills", href: "#skills" },
  { label: "Projects", href: "#projects" },
  { label: "Education", href: "#education" },
  { label: "Contact", href: "#contact" },
];
---

<nav
  id="navbar"
  class="fixed top-0 left-0 w-full z-[999] nav-glass transition-all duration-500 translate-y-[-100%]"
>
  <div class="container mx-auto px-6 flex items-center justify-between h-16">
    <!-- Logo -->
    <a
      href="#home"
      class="nav-logo flex items-center gap-2 text-xl font-bold group"
      id="nav-logo"
    >
      <span
        class="w-8 h-8 rounded-lg bg-gradient-to-br from-accent-blue to-accent-cyan flex items-center justify-center text-sm font-black text-white shadow-lg shadow-blue-500/20 group-hover:shadow-blue-500/40 transition-shadow"
      >
        AP
      </span>
      <span class="text-text-primary font-outfit tracking-tight">
        Arsh<span class="gradient-text">.</span>
      </span>
    </a>

    <!-- Desktop Links -->
    <div class="hidden md:flex items-center gap-1" id="nav-links">
      {
        navLinks.map((link) => (
          <a
            href={link.href}
            class="nav-link px-4 py-2 text-sm font-medium text-text-secondary hover:text-text-primary transition-colors duration-300 rounded-lg hover:bg-white/5 relative"
          >
            {link.label}
            <span class="nav-indicator absolute bottom-0 left-1/2 -translate-x-1/2 w-0 h-0.5 bg-gradient-to-r from-accent-blue to-accent-cyan rounded-full transition-all duration-300" />
          </a>
        ))
      }
    </div>

    <!-- CTA Button -->
    <div class="hidden md:block">
      <a href="#contact" class="btn-nav">
        Say Hello
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
        </svg>
      </a>
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-btn"
      class="md:hidden flex flex-col gap-1.5 p-2 rounded-lg hover:bg-white/5 transition-colors"
      aria-label="Toggle menu"
    >
      <span
        class="hamburger-line w-6 h-0.5 bg-text-primary rounded-full transition-all duration-300"
      ></span>
      <span
        class="hamburger-line w-6 h-0.5 bg-text-primary rounded-full transition-all duration-300"
      ></span>
      <span
        class="hamburger-line w-4 h-0.5 bg-text-primary rounded-full transition-all duration-300"
      ></span>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="md:hidden overflow-hidden max-h-0 transition-all duration-500 ease-in-out"
  >
    <div class="px-6 py-4 border-t border-border-subtle flex flex-col gap-2">
      {
        navLinks.map((link) => (
          <a
            href={link.href}
            class="mobile-nav-link block px-4 py-3 text-text-secondary hover:text-text-primary hover:bg-white/5 rounded-lg transition-all font-medium"
          >
            {link.label}
          </a>
        ))
      }
      <a href="#contact" class="btn btn-primary mt-2 text-center">Say Hello</a>
    </div>
  </div>
</nav>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    const navbar = document.getElementById("navbar");
    const mobileBtn = document.getElementById("mobile-menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");
    const hamburgerLines = document.querySelectorAll(".hamburger-line");
    let menuOpen = false;

    // Reveal navbar after a brief delay (after loading screen)
    gsap.to(navbar, {
      y: 0,
      duration: 0.8,
      delay: 3.5,
      ease: "power3.out",
    });

    // Active Link Tracking
    const sections = document.querySelectorAll("section[id]");
    const navLinks = document.querySelectorAll(".nav-link");

    window.addEventListener("scroll", () => {
      let current = "";
      sections.forEach((section) => {
        const sectionTop = (section as HTMLElement).offsetTop - 100;
        if (window.scrollY >= sectionTop) {
          current = section.getAttribute("id") || "";
        }
      });

      navLinks.forEach((link) => {
        const indicator = link.querySelector(".nav-indicator") as HTMLElement;
        if (indicator) {
          if (link.getAttribute("href") === `#${current}`) {
            indicator.style.width = "60%";
          } else {
            indicator.style.width = "0";
          }
        }
      });
    });

    // Mobile menu toggle
    if (mobileBtn && mobileMenu) {
      mobileBtn.addEventListener("click", () => {
        menuOpen = !menuOpen;
        if (menuOpen) {
          mobileMenu.style.maxHeight = mobileMenu.scrollHeight + "px";
          hamburgerLines[0]?.classList.add("rotate-45", "translate-y-2");
          hamburgerLines[1]?.classList.add("opacity-0");
          hamburgerLines[2]?.classList.add(
            "-rotate-45",
            "-translate-y-2",
            "w-6",
          );
        } else {
          mobileMenu.style.maxHeight = "0";
          hamburgerLines[0]?.classList.remove("rotate-45", "translate-y-2");
          hamburgerLines[1]?.classList.remove("opacity-0");
          hamburgerLines[2]?.classList.remove(
            "-rotate-45",
            "-translate-y-2",
            "w-6",
          );
        }
      });

      // Close on mobile link click
      document.querySelectorAll(".mobile-nav-link").forEach((link) => {
        link.addEventListener("click", () => {
          menuOpen = false;
          mobileMenu.style.maxHeight = "0";
          hamburgerLines[0]?.classList.remove("rotate-45", "translate-y-2");
          hamburgerLines[1]?.classList.remove("opacity-0");
          hamburgerLines[2]?.classList.remove(
            "-rotate-45",
            "-translate-y-2",
            "w-6",
          );
        });
      });
    }

    // Navbar shadow on scroll
    window.addEventListener("scroll", () => {
      if (navbar) {
        if (window.scrollY > 50) {
          navbar.classList.add("nav-scrolled");
        } else {
          navbar.classList.remove("nav-scrolled");
        }
      }
    });
  });
</script>

<style>
  .nav-scrolled {
    box-shadow:
      0 4px 30px rgba(0, 0, 0, 0.3),
      0 0 60px rgba(59, 130, 246, 0.05);
  }

  .nav-link:hover .nav-indicator {
    width: 60% !important;
  }

  .btn-nav {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1.2rem;
    font-size: 0.85rem;
    font-weight: 600;
    color: #e8edf5;
    border: 1.5px solid rgba(59, 130, 246, 0.3);
    border-radius: 0.6rem;
    transition: all 0.3s ease;
    background: transparent;
  }

  .btn-nav:hover {
    border-color: #3b82f6;
    background: rgba(59, 130, 246, 0.08);
    box-shadow: 0 0 25px rgba(59, 130, 246, 0.15);
    transform: translateY(-1px);
  }

  .btn-nav svg {
    transition: transform 0.3s ease;
  }

  .btn-nav:hover svg {
    transform: translateX(3px);
  }
</style>
